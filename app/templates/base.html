<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Paper Analyzer{% endblock %}</title>

    <!-- Tailwind CSS -->

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/output.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="{{ url_for('static', filename='js/preline.js') }}"></script>

    <!-- Preline + Flowbite -->
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
    <script src="https://unpkg.com/preline@latest/dist/preline.js"></script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    {% block head %}{% endblock %}
  </head>
  <body
    class="flex flex-col overflow-x-hidden min-h-screen text-gray-800 font-sans"
    style="background-color: #10141e"
  >
    <!-- Navbar (conditionally rendered) -->
    {% if show_navbar is not defined or show_navbar %} {% if
    session.get('user_id') %} {% include 'partials/navbar_logged_in.html' %} {%
    else %} {% include 'partials/navbar_guest.html' %} {% endif %} {% endif %}
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <!-- Relative container to position absolute alerts inside -->
    <div class="relative w-full flex justify-center mt-5">
      <!-- Alert container -->
      <div class="absolute flex flex-col gap-3 w-full max-w-md z-50">
        {% set alert_classes = { 'info': 'text-blue-800 border border-blue-300
        bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-blue-800',
        'danger': 'text-red-800 border border-red-300 bg-red-50 dark:bg-gray-800
        dark:text-red-400 dark:border-red-800', 'error': 'text-red-800 border
        border-red-300 bg-red-50 dark:bg-gray-800 dark:text-red-400
        dark:border-red-800', 'success': 'text-green-800 border border-green-300
        bg-green-50 dark:bg-gray-800 dark:text-green-400 dark:border-green-800',
        'warning': 'text-yellow-800 border border-yellow-300 bg-yellow-50
        dark:bg-gray-800 dark:text-yellow-300 dark:border-yellow-800', 'dark':
        'text-gray-800 border border-gray-300 bg-gray-50 dark:bg-gray-800
        dark:text-gray-300 dark:border-gray-600' } %} {% set icon_paths = {
        'info': 'M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5
        1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1
        0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z', 'danger': 'M10 .5a9.5 9.5 0 1 0
        9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1
        0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1
        0 0 1 0 2Z', 'error': 'M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10
        .5ZM9 7h2v6H9V7Zm0 8h2v2H9v-2Z', 'success': 'M10 .5a9.5 9.5 0 1 0 9.5
        9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12
        15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0
        2Z', 'warning': 'M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5
        4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1
        0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z', 'dark': 'M10 .5a9.5 9.5 0
        1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1
        0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1
        0 0 1 0 2Z' } %} {% for category, message in messages %}
        <div
          class="alert-box flex items-center p-4 text-sm rounded-lg transition-opacity duration-1000 ease-in-out opacity-100 mx-4 sm:mx-auto sm:max-w-md {{ alert_classes.get(category, alert_classes['dark']) }}"
          role="alert"
        >
          <svg
            class="shrink-0 inline w-4 h-4 me-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 20 20"
          >
            <path d="{{ icon_paths.get(category, icon_paths['dark']) }}" />
          </svg>
          <span class="sr-only">{{ category|capitalize }}</span>
          <div>
            <span class="font-medium">{{ category|capitalize }} alert!</span> {{
            message }}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %} {% endwith %}

    <!-- Page Content -->
    <main class="max-w-5xl mx-auto px-4 pt-8">
      {% block content %}{% endblock %}
    </main>

    {% block scripts %}{% endblock %}

    <!-- Page footer -->
    <footer class="bg-white rounded-lg shadow-sm dark:bg-gray-900 m-4">
      <div class="w-full max-w-screen-xl mx-auto p-4 md:py-8">
        <div class="sm:flex sm:items-center sm:justify-between">
          <a href="/" class="flex items-center gap-0 mb-4 sm:mb-0">
            <div class="h-15 flex items-center">
              <img
                src="{{ url_for('static', filename='images/papalyze.svg') }}"
                class="h-full w-auto"
                alt="Papalyze Logo"
              />
            </div>
            <span
              class="self-center text-1xl font-semibold whitespace-nowrap dark:text-white -ml-2"
              >Papalyze</span
            >
          </a>
          <ul
            class="flex flex-wrap items-center mb-6 text-sm font-medium text-gray-500 sm:mb-0 dark:text-gray-400"
          >
            <li>
              <a href="/about.html" class="hover:underline me-4 md:me-6"
                >About</a
              >
            </li>
            <li>
              <a href="/" class="hover:underline me-4 md:me-6"
                >Privacy Policy</a
              >
            </li>
            <li>
              <a href="/" class="hover:underline me-4 md:me-6">Licensing</a>
            </li>
            <li>
              <a href="/contact.html" class="hover:underline">Contact</a>
            </li>
          </ul>
        </div>
        <hr
          class="my-6 border-gray-200 sm:mx-auto dark:border-gray-700 lg:my-8"
        />
        <span
          class="block text-sm text-gray-500 sm:text-center dark:text-gray-400"
          >© 2025 <a href="/" class="hover:underline">Papalyze™</a>. All Rights
          Reserved.</span
        >
      </div>
    </footer>

    <audio
      id="alert-sound"
      src="{{ url_for('static', filename='sound/alert.mp3') }}"
      preload="auto"
    ></audio>

    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        const alertSound = document.getElementById("alert-sound");
        const alertBoxes = document.querySelectorAll(".alert-box");

        if (alertBoxes.length > 0 && alertSound) {
          // Play sound once immediately for the first alert
          alertSound.currentTime = 0;
          alertSound.play().catch((err) => {
            console.warn("Sound autoplay blocked:", err);
          });
        }

        alertBoxes.forEach((alertBox, index) => {
          const delay = 3000 * index;

          // Remove sound play inside here

          // Fade and remove alert
          setTimeout(() => {
            alertBox.classList.remove("opacity-100");
            alertBox.classList.add("opacity-0");
            setTimeout(() => {
              alertBox.remove();
            }, 1000);
          }, delay + 3000);
        });
      });
    </script>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-7RHG8736TN"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-7RHG8736TN");
    </script>
  </body>
</html>
